(()=>{function n(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,o=Array(t);e<t;e++)o[e]=n[e];return o}function t(t){var e,o,a={high:"#d32f2f",medium:"#f57c00",low:"#ffa000",safe:"#388e3c"};return'\n        <div class="threat-container">\n            <div class="threat-header" style="color: '.concat(a[t.threatLevel],'">\n                <span class="warning-icon">‚ö†Ô∏è</span>\n                <h2>Security Warning</h2>\n            </div>\n            \n            <div class="threat-content">\n                <div class="dangerous-url">\n                    <strong>Suspicious URL:</strong> ').concat(t.url,'\n                </div>\n\n                <div class="threat-section">\n                    <h3>Why this is suspicious:</h3>\n                    <ul class="threat-list">\n                        ').concat(t.reasons.map((function(n){return"<li>".concat(n,"</li>")})).join(""),'\n                    </ul>\n                </div>\n\n                <div class="whois-info">\n                    <h3>Domain Information:</h3>\n                    ').concat((o=t.whoisInfo,console.log("Formatting WHOIS info:",o),o&&0!==Object.keys(o).length?'\n        <div class="domain-owner-section">\n            <div class="domain-owner-header">\n                <i>‚ÑπÔ∏è</i>\n                <h3>Domain Information</h3>\n            </div>\n            <div class="alert-box warning">\n                <i>‚ö†Ô∏è</i>\n                <div>\n                    <strong>Be Aware:</strong> This domain might be impersonating a legitimate website. Always verify the domain owner\'s information carefully.\n                </div>\n            </div>\n            <div class="domain-details">\n                <div class="detail-card">\n                    <h4>Registration Details</h4>\n                    <p><strong>Created:</strong> '.concat("N/A"!==o["Creation Date"]?new Date(o["Creation Date"]).toLocaleDateString():"Unknown","</p>\n                    <p><strong>Expires:</strong> ").concat("N/A"!==o["Expiration Date"]?new Date(o["Expiration Date"]).toLocaleDateString():"Unknown","</p>\n                    <p><strong>Last Updated:</strong> ").concat("N/A"!==o["Updated Date"]?new Date(o["Updated Date"]).toLocaleDateString():"Unknown","</p>\n                    <p><strong>Registrar:</strong> ").concat(o.Registrar||"Unknown",'</p>\n                </div>\n                <div class="detail-card">\n                    <h4>Technical Details</h4>\n                    <p><strong>IP Addresses:</strong> ').concat(o["IP Addresses"]||"N/A","</p>\n                    <p><strong>Name Servers:</strong> ").concat(o["Name Servers"]||"N/A","</p>\n                    <p><strong>DNSSEC:</strong> ").concat(o.DNSSEC||"N/A","</p>\n                </div>\n            </div>\n            ").concat(o["MX Records"]?'\n                <div class="detail-card" style="margin-top: 15px;">\n                    <h4>Email Configuration</h4>\n                    <p><strong>Mail Servers:</strong> '.concat(o["MX Records"],"</p>\n                    ").concat(o["TXT Records"]?"<p><strong>SPF/DMARC:</strong> ".concat(o["TXT Records"],"</p>"):"","\n                </div>\n            "):"","\n        </div>\n    ")+'\n        <div style="margin-top: 20px;">\n            <h4>Complete Registration Information</h4>\n            <table class="whois-table">\n                '.concat(Object.entries(o).map((function(t){var e,o,a=(o=2,function(n){if(Array.isArray(n))return n}(e=t)||function(n,t){var e=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var o,a,r,i,s=[],c=!0,d=!1;try{if(r=(e=e.call(n)).next,0===t){if(Object(e)!==e)return;c=!1}else for(;!(c=(o=r.call(e)).done)&&(s.push(o.value),s.length!==t);c=!0);}catch(n){d=!0,a=n}finally{try{if(!c&&null!=e.return&&(i=e.return(),Object(i)!==i))return}finally{if(d)throw a}}return s}}(e,o)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var o={}.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(t,e):void 0}}(e,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=a[0],i=a[1];return"\n                    <tr>\n                        <td>".concat(r,"</td>\n                        <td>").concat(i,"</td>\n                    </tr>\n                ")})).join(""),"\n            </table>\n        </div>\n    "):'\n            <div class="alert-box warning">\n                <i>‚ö†Ô∏è</i>\n                <div>\n                    <strong>WHOIS Information Unavailable:</strong> Unable to retrieve domain registration details. This could be due to privacy protection or API limitations.\n                </div>\n            </div>\n        '),'\n                </div>\n\n                <div class="sources-section">\n                    <h3>Sources and Additional Information:</h3>\n                    ').concat((e=t.sources,e&&0!==e.length?e.map((function(n){return'\n        <div class="source-item">\n            <span>üîó</span>\n            <div>\n                <strong>'.concat(n.name,"</strong>\n                <p>").concat(n.description,"</p>\n                ").concat(n.url?'<a href="'.concat(n.url,'" target="_blank">Learn more</a>'):"","\n            </div>\n        </div>\n    ")})).join(""):"<p>No additional sources available.</p>"),'\n                </div>\n\n                <div class="threat-section">\n                    <h3>Recommendations:</h3>\n                    <ul class="threat-list recommendations">\n                        ').concat(t.recommendations.map((function(n){return"<li>".concat(n,"</li>")})).join(""),'\n                    </ul>\n                </div>\n\n                <div class="threat-metadata">\n                    <p>Detected at: ').concat(new Date(t.detectedAt).toLocaleString(),"</p>\n                    <p>Source: ").concat(t.source,'</p>\n                    <p>Threat Level: <span style="color: ').concat(a[t.threatLevel],'">').concat(t.threatLevel.toUpperCase(),'</span></p>\n                </div>\n            </div>\n\n            <div class="action-buttons">\n                <button id="ignoreButton" class="btn warning">Ignore (Not Recommended)</button>\n                <button id="blockButton" class="btn primary">Block Content</button>\n                <button id="reportButton" class="btn secondary">Report as False Positive</button>\n            </div>\n        </div>\n    ')}document.addEventListener("DOMContentLoaded",(function(){var n;(n=document.createElement("style")).textContent="\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n            margin: 0;\n            padding: 20px;\n            background: #f5f5f5;\n        }\n\n        .threat-container {\n            max-width: 600px;\n            margin: 0 auto;\n            background: white;\n            border-radius: 8px;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n            padding: 20px;\n        }\n\n        .threat-header {\n            display: flex;\n            align-items: center;\n            gap: 12px;\n            margin-bottom: 20px;\n            padding-bottom: 12px;\n            border-bottom: 2px solid #f0f0f0;\n        }\n\n        .warning-icon {\n            font-size: 24px;\n        }\n\n        h2 {\n            margin: 0;\n            font-size: 24px;\n        }\n\n        h3 {\n            margin: 0 0 12px 0;\n            color: #333;\n            font-size: 18px;\n        }\n\n        .threat-section {\n            margin-bottom: 24px;\n        }\n\n        .threat-list {\n            margin: 0;\n            padding-left: 24px;\n        }\n\n        .threat-list li {\n            margin-bottom: 8px;\n            line-height: 1.5;\n        }\n\n        .recommendations li {\n            color: #2196f3;\n        }\n\n        .threat-metadata {\n            background: #f8f9fa;\n            padding: 12px;\n            border-radius: 4px;\n            margin-bottom: 20px;\n        }\n\n        .threat-metadata p {\n            margin: 8px 0;\n            color: #666;\n        }\n\n        .action-buttons {\n            display: flex;\n            gap: 12px;\n            justify-content: flex-end;\n            margin-top: 20px;\n        }\n\n        .btn {\n            padding: 10px 20px;\n            border: none;\n            border-radius: 4px;\n            cursor: pointer;\n            font-weight: 500;\n            transition: all 0.2s;\n        }\n\n        .btn.primary {\n            background: #2196f3;\n            color: white;\n        }\n\n        .btn.warning {\n            background: #ff9800;\n            color: white;\n        }\n\n        .btn.secondary {\n            background: #f5f5f5;\n            color: #333;\n            border: 1px solid #ddd;\n        }\n\n        .btn:hover {\n            opacity: 0.9;\n            transform: translateY(-1px);\n        }\n    ",document.head.appendChild(n),function(){var n=function(){var n=new URLSearchParams(window.location.search);try{return{url:n.get("url")||"",type:n.get("type")||"unknown",source:n.get("source")||"unknown",threatLevel:n.get("threatLevel")||"high",reasons:JSON.parse(n.get("reasons")||"[]"),recommendations:JSON.parse(n.get("recommendations")||"[]"),detectedAt:n.get("detectedAt")||(new Date).toISOString(),whoisInfo:JSON.parse(n.get("whoisInfo")||"{}"),sources:JSON.parse(n.get("sources")||"[]"),details:JSON.parse(n.get("details")||"[]")}}catch(t){return console.error("Error parsing URL parameters:",t),{url:n.get("url")||"",type:"unknown",source:"unknown",threatLevel:"high",reasons:[],recommendations:[],detectedAt:(new Date).toISOString(),whoisInfo:{},sources:[],details:[]}}}();console.log("Threat info:",n);var e,o,a,r=document.getElementById("warning-container");r&&(r.innerHTML=t(n),null===(e=document.getElementById("ignoreButton"))||void 0===e||e.addEventListener("click",(function(){confirm("Are you sure you want to ignore this warning? This could be dangerous!")&&window.close()})),null===(o=document.getElementById("blockButton"))||void 0===o||o.addEventListener("click",(function(){chrome.runtime.sendMessage({type:"BLOCK_CONTENT",data:n}),window.close()})),null===(a=document.getElementById("reportButton"))||void 0===a||a.addEventListener("click",(function(){chrome.runtime.sendMessage({type:"REPORT_FALSE_POSITIVE",data:n}),alert("Thank you for your report. We will review this content."),window.close()})))}()}))})();